%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Types
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%[(8 counting) ag
DATA AnnPrim 
  | Zero
  | One
  | Infinity

DATA Annotation
  | Var v : {HsName}
  | Val v : AnnotationValue
 
TYPE Annotations = [Annotation]
TYPE Types = [Type]
TYPE RhoTypes = [RhoType]
TYPE Constraints = [Constraint]
TYPE Fields = [Field]

DATA Field
  | Strict t : RhoType
  | Lazy t : RhoType

DATA Type
  | Var v : {HsName}
  | Data n : {HsName} as : Annotations ts : Types
  | App t1 : Type t2 : Type
  | Func t1 : RhoType t2 : EtaType
  | Tup ts : RhoTypes
  | Error e : {String}

DATA Scheme
  | Var v : {HsName}
  | Forall as : {Set HsName} ts : {Set HsName} cs : Constraints t : Type
  | ForallTemp as : {Set HsName} ts : {Set HsName} cs : {Set Var} t : Type

DATA EtaType
  | Eta t : Type a : Annotation

DATA EtaScheme
  | Eta s : Scheme a : Annotation

DATA RhoType
  | Rho e : EtaType a : Annotation
 
DATA RhoScheme
  | Rho e : EtaScheme a : Annotation

TYPE Env = MAP {HsName} RhoScheme

DATA Constraint
  | Ann c : ConstraintAnn
  | Eq c : ConstraintEq
  | Inst name : {HsName} s : Scheme t : Type
  | Gen name : {HsName} t : Type u : Annotation d : Annotation v0: Annotation d0: Annotation c : {Var} e : Env s : Scheme

DATA ConstraintAnn
  | Plus a1 : Annotation a2 : Annotation a : Annotation
  | Union a1 : Annotation a2 : Annotation a : Annotation
  | Times a1 : Annotation a2 : Annotation a : Annotation
  | Cond a1 : Annotation a2 : Annotation a : Annotation

DATA ConstraintEq
  | Ann a1 : Annotation a2 : Annotation
  | Type t1 : Type t2 : Type
  | Scheme s1 : Scheme s2 : Scheme
%%]